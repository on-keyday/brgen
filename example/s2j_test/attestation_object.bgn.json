{"success": true,"files": ["C:/workspace/shbrgen/brgen/example/attestation_object.bgn"],"ast": {"node":[{"node_type":"program","loc":{"pos":{"begin":0,"end":2},"file":1,"line":1,"col":1},"body":{"struct_type":1,"elements":[2,50],"global_scope":0}},{"node_type":"struct_type","loc":{"pos":{"begin":0,"end":2},"file":1,"line":1,"col":1},"body":{"is_explicit":false,"non_dynamic_allocation":true,"bit_alignment":"byte_aligned","bit_size":0,"fields":[2,50],"base":0,"recursive":false,"fixed_header_size":0,"fixed_tail_size":0}},{"node_type":"format","loc":{"pos":{"begin":2,"end":8},"file":1,"line":2,"col":1},"body":{"belong":null,"belong_struct":1,"ident":3,"body":4,"encode_fn":null,"decode_fn":null,"cast_fns":[],"depends":[44,48],"state_variables":[]}},{"node_type":"ident","loc":{"pos":{"begin":9,"end":26},"file":1,"line":2,"col":8},"body":{"expr_type":null,"constant_level":"unknown","ident":"AuthEnticatorData","usage":"define_format","base":2,"scope":0}},{"node_type":"indent_block","loc":{"pos":{"begin":29,"end":33},"file":1,"line":3,"col":1},"body":{"struct_type":5,"elements":[6,9,12,15,21,24,27,30,36,39,42,46],"scope":1}},{"node_type":"struct_type","loc":{"pos":{"begin":29,"end":33},"file":1,"line":3,"col":1},"body":{"is_explicit":false,"non_dynamic_allocation":false,"bit_alignment":"byte_aligned","bit_size":null,"fields":[6,9,12,15,21,24,27,30,36,39,42,46],"base":2,"recursive":false,"fixed_header_size":72,"fixed_tail_size":0}},{"node_type":"field","loc":{"pos":{"begin":33,"end":43},"file":1,"line":3,"col":5},"body":{"belong":2,"belong_struct":5,"ident":7,"colon_loc":{"pos":{"begin":44,"end":45},"file":1,"line":3,"col":16},"is_state_variable":false,"field_type":8,"arguments":null,"offset_bit":0,"offset_recent":0,"tail_offset_bit":null,"tail_offset_recent":40,"bit_alignment":"byte_aligned","eventual_bit_alignment":"byte_aligned","follow":"fixed","eventual_follow":"normal","next":9}},{"node_type":"ident","loc":{"pos":{"begin":33,"end":43},"file":1,"line":3,"col":5},"body":{"expr_type":8,"constant_level":"variable","ident":"rp_id_hash","usage":"define_field","base":6,"scope":1}},{"node_type":"int_type","loc":{"pos":{"begin":45,"end":49},"file":1,"line":3,"col":17},"body":{"is_explicit":true,"non_dynamic_allocation":true,"bit_alignment":"byte_aligned","bit_size":32,"endian":"little","is_signed":false,"is_common_supported":true}},{"node_type":"field","loc":{"pos":{"begin":55,"end":57},"file":1,"line":4,"col":5},"body":{"belong":2,"belong_struct":5,"ident":10,"colon_loc":{"pos":{"begin":58,"end":59},"file":1,"line":4,"col":8},"is_state_variable":false,"field_type":11,"arguments":null,"offset_bit":32,"offset_recent":32,"tail_offset_bit":null,"tail_offset_recent":39,"bit_alignment":"bit_1","eventual_bit_alignment":"byte_aligned","follow":"fixed","eventual_follow":"normal","next":12}},{"node_type":"ident","loc":{"pos":{"begin":55,"end":57},"file":1,"line":4,"col":5},"body":{"expr_type":11,"constant_level":"variable","ident":"ed","usage":"define_field","base":9,"scope":1}},{"node_type":"int_type","loc":{"pos":{"begin":59,"end":61},"file":1,"line":4,"col":9},"body":{"is_explicit":true,"non_dynamic_allocation":true,"bit_alignment":"bit_1","bit_size":1,"endian":"unspec","is_signed":false,"is_common_supported":false}},{"node_type":"field","loc":{"pos":{"begin":67,"end":69},"file":1,"line":5,"col":5},"body":{"belong":2,"belong_struct":5,"ident":13,"colon_loc":{"pos":{"begin":70,"end":71},"file":1,"line":5,"col":8},"is_state_variable":false,"field_type":14,"arguments":null,"offset_bit":33,"offset_recent":33,"tail_offset_bit":null,"tail_offset_recent":38,"bit_alignment":"bit_2","eventual_bit_alignment":"byte_aligned","follow":"fixed","eventual_follow":"normal","next":15}},{"node_type":"ident","loc":{"pos":{"begin":67,"end":69},"file":1,"line":5,"col":5},"body":{"expr_type":14,"constant_level":"variable","ident":"at","usage":"define_field","base":12,"scope":1}},{"node_type":"int_type","loc":{"pos":{"begin":71,"end":73},"file":1,"line":5,"col":9},"body":{"is_explicit":true,"non_dynamic_allocation":true,"bit_alignment":"bit_1","bit_size":1,"endian":"unspec","is_signed":false,"is_common_supported":false}},{"node_type":"field","loc":{"pos":{"begin":79,"end":88},"file":1,"line":6,"col":5},"body":{"belong":2,"belong_struct":5,"ident":16,"colon_loc":{"pos":{"begin":88,"end":89},"file":1,"line":6,"col":14},"is_state_variable":false,"field_type":17,"arguments":18,"offset_bit":34,"offset_recent":34,"tail_offset_bit":null,"tail_offset_recent":37,"bit_alignment":"bit_3","eventual_bit_alignment":"byte_aligned","follow":"fixed","eventual_follow":"normal","next":21}},{"node_type":"ident","loc":{"pos":{"begin":79,"end":88},"file":1,"line":6,"col":5},"body":{"expr_type":17,"constant_level":"variable","ident":"reserved1","usage":"define_field","base":15,"scope":1}},{"node_type":"int_type","loc":{"pos":{"begin":89,"end":91},"file":1,"line":6,"col":15},"body":{"is_explicit":true,"non_dynamic_allocation":true,"bit_alignment":"bit_1","bit_size":1,"endian":"unspec","is_signed":false,"is_common_supported":false}},{"node_type":"field_argument","loc":{"pos":{"begin":91,"end":92},"file":1,"line":6,"col":17},"body":{"raw_arguments":19,"end_loc":{"pos":{"begin":93,"end":94},"file":1,"line":6,"col":19},"collected_arguments":[19],"arguments":[19],"alignment":null,"alignment_value":null,"sub_byte_length":null,"sub_byte_begin":null,"peek":null,"peek_value":null,"type_map":null,"metadata":[]}},{"node_type":"int_literal","loc":{"pos":{"begin":92,"end":93},"file":1,"line":6,"col":18},"body":{"expr_type":20,"constant_level":"constant","value":"0"}},{"node_type":"int_literal_type","loc":{"pos":{"begin":92,"end":93},"file":1,"line":6,"col":18},"body":{"is_explicit":false,"non_dynamic_allocation":false,"bit_alignment":"not_target","bit_size":1,"base":19}},{"node_type":"field","loc":{"pos":{"begin":100,"end":102},"file":1,"line":7,"col":5},"body":{"belong":2,"belong_struct":5,"ident":22,"colon_loc":{"pos":{"begin":103,"end":104},"file":1,"line":7,"col":8},"is_state_variable":false,"field_type":23,"arguments":null,"offset_bit":35,"offset_recent":35,"tail_offset_bit":null,"tail_offset_recent":36,"bit_alignment":"bit_4","eventual_bit_alignment":"byte_aligned","follow":"fixed","eventual_follow":"normal","next":24}},{"node_type":"ident","loc":{"pos":{"begin":100,"end":102},"file":1,"line":7,"col":5},"body":{"expr_type":23,"constant_level":"variable","ident":"bs","usage":"define_field","base":21,"scope":1}},{"node_type":"int_type","loc":{"pos":{"begin":104,"end":106},"file":1,"line":7,"col":9},"body":{"is_explicit":true,"non_dynamic_allocation":true,"bit_alignment":"bit_1","bit_size":1,"endian":"unspec","is_signed":false,"is_common_supported":false}},{"node_type":"field","loc":{"pos":{"begin":112,"end":114},"file":1,"line":8,"col":5},"body":{"belong":2,"belong_struct":5,"ident":25,"colon_loc":{"pos":{"begin":115,"end":116},"file":1,"line":8,"col":8},"is_state_variable":false,"field_type":26,"arguments":null,"offset_bit":36,"offset_recent":36,"tail_offset_bit":null,"tail_offset_recent":35,"bit_alignment":"bit_5","eventual_bit_alignment":"byte_aligned","follow":"fixed","eventual_follow":"normal","next":27}},{"node_type":"ident","loc":{"pos":{"begin":112,"end":114},"file":1,"line":8,"col":5},"body":{"expr_type":26,"constant_level":"variable","ident":"be","usage":"define_field","base":24,"scope":1}},{"node_type":"int_type","loc":{"pos":{"begin":116,"end":118},"file":1,"line":8,"col":9},"body":{"is_explicit":true,"non_dynamic_allocation":true,"bit_alignment":"bit_1","bit_size":1,"endian":"unspec","is_signed":false,"is_common_supported":false}},{"node_type":"field","loc":{"pos":{"begin":124,"end":126},"file":1,"line":9,"col":5},"body":{"belong":2,"belong_struct":5,"ident":28,"colon_loc":{"pos":{"begin":127,"end":128},"file":1,"line":9,"col":8},"is_state_variable":false,"field_type":29,"arguments":null,"offset_bit":37,"offset_recent":37,"tail_offset_bit":null,"tail_offset_recent":34,"bit_alignment":"bit_6","eventual_bit_alignment":"byte_aligned","follow":"fixed","eventual_follow":"normal","next":30}},{"node_type":"ident","loc":{"pos":{"begin":124,"end":126},"file":1,"line":9,"col":5},"body":{"expr_type":29,"constant_level":"variable","ident":"uv","usage":"define_field","base":27,"scope":1}},{"node_type":"int_type","loc":{"pos":{"begin":128,"end":130},"file":1,"line":9,"col":9},"body":{"is_explicit":true,"non_dynamic_allocation":true,"bit_alignment":"bit_1","bit_size":1,"endian":"unspec","is_signed":false,"is_common_supported":false}},{"node_type":"field","loc":{"pos":{"begin":136,"end":145},"file":1,"line":10,"col":5},"body":{"belong":2,"belong_struct":5,"ident":31,"colon_loc":{"pos":{"begin":146,"end":147},"file":1,"line":10,"col":15},"is_state_variable":false,"field_type":32,"arguments":33,"offset_bit":38,"offset_recent":38,"tail_offset_bit":null,"tail_offset_recent":33,"bit_alignment":"bit_7","eventual_bit_alignment":"byte_aligned","follow":"fixed","eventual_follow":"normal","next":36}},{"node_type":"ident","loc":{"pos":{"begin":136,"end":145},"file":1,"line":10,"col":5},"body":{"expr_type":32,"constant_level":"variable","ident":"reserved2","usage":"define_field","base":30,"scope":1}},{"node_type":"int_type","loc":{"pos":{"begin":147,"end":149},"file":1,"line":10,"col":16},"body":{"is_explicit":true,"non_dynamic_allocation":true,"bit_alignment":"bit_1","bit_size":1,"endian":"unspec","is_signed":false,"is_common_supported":false}},{"node_type":"field_argument","loc":{"pos":{"begin":149,"end":150},"file":1,"line":10,"col":18},"body":{"raw_arguments":34,"end_loc":{"pos":{"begin":151,"end":152},"file":1,"line":10,"col":20},"collected_arguments":[34],"arguments":[34],"alignment":null,"alignment_value":null,"sub_byte_length":null,"sub_byte_begin":null,"peek":null,"peek_value":null,"type_map":null,"metadata":[]}},{"node_type":"int_literal","loc":{"pos":{"begin":150,"end":151},"file":1,"line":10,"col":19},"body":{"expr_type":35,"constant_level":"constant","value":"0"}},{"node_type":"int_literal_type","loc":{"pos":{"begin":150,"end":151},"file":1,"line":10,"col":19},"body":{"is_explicit":false,"non_dynamic_allocation":false,"bit_alignment":"not_target","bit_size":1,"base":34}},{"node_type":"field","loc":{"pos":{"begin":158,"end":160},"file":1,"line":11,"col":5},"body":{"belong":2,"belong_struct":5,"ident":37,"colon_loc":{"pos":{"begin":161,"end":162},"file":1,"line":11,"col":8},"is_state_variable":false,"field_type":38,"arguments":null,"offset_bit":39,"offset_recent":39,"tail_offset_bit":null,"tail_offset_recent":32,"bit_alignment":"byte_aligned","eventual_bit_alignment":"byte_aligned","follow":"fixed","eventual_follow":"normal","next":39}},{"node_type":"ident","loc":{"pos":{"begin":158,"end":160},"file":1,"line":11,"col":5},"body":{"expr_type":38,"constant_level":"variable","ident":"up","usage":"define_field","base":36,"scope":1}},{"node_type":"int_type","loc":{"pos":{"begin":162,"end":164},"file":1,"line":11,"col":9},"body":{"is_explicit":true,"non_dynamic_allocation":true,"bit_alignment":"bit_1","bit_size":1,"endian":"unspec","is_signed":false,"is_common_supported":false}},{"node_type":"field","loc":{"pos":{"begin":170,"end":177},"file":1,"line":12,"col":5},"body":{"belong":2,"belong_struct":5,"ident":40,"colon_loc":{"pos":{"begin":178,"end":179},"file":1,"line":12,"col":13},"is_state_variable":false,"field_type":41,"arguments":null,"offset_bit":40,"offset_recent":40,"tail_offset_bit":null,"tail_offset_recent":0,"bit_alignment":"byte_aligned","eventual_bit_alignment":"byte_aligned","follow":"normal","eventual_follow":"normal","next":42}},{"node_type":"ident","loc":{"pos":{"begin":170,"end":177},"file":1,"line":12,"col":5},"body":{"expr_type":41,"constant_level":"variable","ident":"counter","usage":"define_field","base":39,"scope":1}},{"node_type":"int_type","loc":{"pos":{"begin":179,"end":183},"file":1,"line":12,"col":14},"body":{"is_explicit":true,"non_dynamic_allocation":true,"bit_alignment":"byte_aligned","bit_size":32,"endian":"big","is_signed":false,"is_common_supported":true}},{"node_type":"field","loc":{"pos":{"begin":189,"end":213},"file":1,"line":13,"col":5},"body":{"belong":2,"belong_struct":5,"ident":43,"colon_loc":{"pos":{"begin":214,"end":215},"file":1,"line":13,"col":30},"is_state_variable":false,"field_type":44,"arguments":null,"offset_bit":72,"offset_recent":72,"tail_offset_bit":0,"tail_offset_recent":0,"bit_alignment":"byte_aligned","eventual_bit_alignment":"byte_aligned","follow":"end","eventual_follow":"end","next":46}},{"node_type":"ident","loc":{"pos":{"begin":189,"end":213},"file":1,"line":13,"col":5},"body":{"expr_type":44,"constant_level":"variable","ident":"attested_credential_data","usage":"define_field","base":42,"scope":1}},{"node_type":"ident_type","loc":{"pos":{"begin":215,"end":243},"file":1,"line":13,"col":31},"body":{"is_explicit":true,"non_dynamic_allocation":false,"bit_alignment":"byte_aligned","bit_size":null,"import_ref":null,"ident":45,"base":53}},{"node_type":"ident","loc":{"pos":{"begin":215,"end":243},"file":1,"line":13,"col":31},"body":{"expr_type":null,"constant_level":"unknown","ident":"AuthenticatorDataAttestation","usage":"reference_type","base":51,"scope":1}},{"node_type":"field","loc":{"pos":{"begin":249,"end":259},"file":1,"line":14,"col":5},"body":{"belong":2,"belong_struct":5,"ident":47,"colon_loc":{"pos":{"begin":260,"end":261},"file":1,"line":14,"col":16},"is_state_variable":false,"field_type":48,"arguments":null,"offset_bit":null,"offset_recent":0,"tail_offset_bit":null,"tail_offset_recent":0,"bit_alignment":"not_target","eventual_bit_alignment":"not_target","follow":"unknown","eventual_follow":"unknown","next":null}},{"node_type":"ident","loc":{"pos":{"begin":249,"end":259},"file":1,"line":14,"col":5},"body":{"expr_type":48,"constant_level":"variable","ident":"extensions","usage":"define_field","base":46,"scope":1}},{"node_type":"ident_type","loc":{"pos":{"begin":261,"end":284},"file":1,"line":14,"col":17},"body":{"is_explicit":true,"non_dynamic_allocation":false,"bit_alignment":"not_target","bit_size":null,"import_ref":null,"ident":49,"base":null}},{"node_type":"ident","loc":{"pos":{"begin":261,"end":284},"file":1,"line":14,"col":17},"body":{"expr_type":null,"constant_level":"unknown","ident":"AuthenticatorExtensions","usage":"maybe_type","base":null,"scope":1}},{"node_type":"format","loc":{"pos":{"begin":290,"end":296},"file":1,"line":17,"col":1},"body":{"belong":null,"belong_struct":1,"ident":51,"body":52,"encode_fn":null,"decode_fn":null,"cast_fns":[],"depends":[67],"state_variables":[]}},{"node_type":"ident","loc":{"pos":{"begin":297,"end":325},"file":1,"line":17,"col":8},"body":{"expr_type":null,"constant_level":"unknown","ident":"AuthenticatorDataAttestation","usage":"define_format","base":50,"scope":2}},{"node_type":"indent_block","loc":{"pos":{"begin":328,"end":332},"file":1,"line":18,"col":1},"body":{"struct_type":53,"elements":[54,57,60,65],"scope":3}},{"node_type":"struct_type","loc":{"pos":{"begin":328,"end":332},"file":1,"line":18,"col":1},"body":{"is_explicit":false,"non_dynamic_allocation":false,"bit_alignment":"byte_aligned","bit_size":null,"fields":[54,57,60,65],"base":50,"recursive":false,"fixed_header_size":32,"fixed_tail_size":0}},{"node_type":"field","loc":{"pos":{"begin":332,"end":338},"file":1,"line":18,"col":5},"body":{"belong":50,"belong_struct":53,"ident":55,"colon_loc":{"pos":{"begin":339,"end":340},"file":1,"line":18,"col":12},"is_state_variable":false,"field_type":56,"arguments":null,"offset_bit":0,"offset_recent":0,"tail_offset_bit":null,"tail_offset_recent":16,"bit_alignment":"byte_aligned","eventual_bit_alignment":"byte_aligned","follow":"fixed","eventual_follow":"normal","next":57}},{"node_type":"ident","loc":{"pos":{"begin":332,"end":338},"file":1,"line":18,"col":5},"body":{"expr_type":56,"constant_level":"variable","ident":"aaguid","usage":"define_field","base":54,"scope":3}},{"node_type":"int_type","loc":{"pos":{"begin":340,"end":343},"file":1,"line":18,"col":13},"body":{"is_explicit":true,"non_dynamic_allocation":true,"bit_alignment":"byte_aligned","bit_size":16,"endian":"unspec","is_signed":false,"is_common_supported":true}},{"node_type":"field","loc":{"pos":{"begin":349,"end":369},"file":1,"line":19,"col":5},"body":{"belong":50,"belong_struct":53,"ident":58,"colon_loc":{"pos":{"begin":370,"end":371},"file":1,"line":19,"col":26},"is_state_variable":false,"field_type":59,"arguments":null,"offset_bit":16,"offset_recent":16,"tail_offset_bit":null,"tail_offset_recent":0,"bit_alignment":"byte_aligned","eventual_bit_alignment":"byte_aligned","follow":"normal","eventual_follow":"normal","next":60}},{"node_type":"ident","loc":{"pos":{"begin":349,"end":369},"file":1,"line":19,"col":5},"body":{"expr_type":59,"constant_level":"variable","ident":"credential_id_length","usage":"define_field","base":57,"scope":3}},{"node_type":"int_type","loc":{"pos":{"begin":371,"end":374},"file":1,"line":19,"col":27},"body":{"is_explicit":true,"non_dynamic_allocation":true,"bit_alignment":"byte_aligned","bit_size":16,"endian":"unspec","is_signed":false,"is_common_supported":true}},{"node_type":"field","loc":{"pos":{"begin":380,"end":393},"file":1,"line":20,"col":5},"body":{"belong":50,"belong_struct":53,"ident":61,"colon_loc":{"pos":{"begin":394,"end":395},"file":1,"line":20,"col":19},"is_state_variable":false,"field_type":62,"arguments":null,"offset_bit":32,"offset_recent":32,"tail_offset_bit":0,"tail_offset_recent":0,"bit_alignment":"byte_aligned","eventual_bit_alignment":"byte_aligned","follow":"end","eventual_follow":"end","next":65}},{"node_type":"ident","loc":{"pos":{"begin":380,"end":393},"file":1,"line":20,"col":5},"body":{"expr_type":62,"constant_level":"variable","ident":"credential_id","usage":"define_field","base":60,"scope":3}},{"node_type":"array_type","loc":{"pos":{"begin":395,"end":396},"file":1,"line":20,"col":20},"body":{"is_explicit":true,"non_dynamic_allocation":false,"bit_alignment":"byte_aligned","bit_size":null,"end_loc":{"pos":{"begin":416,"end":417},"file":1,"line":20,"col":41},"element_type":63,"length":64,"length_value":null,"is_bytes":true}},{"node_type":"int_type","loc":{"pos":{"begin":417,"end":419},"file":1,"line":20,"col":42},"body":{"is_explicit":true,"non_dynamic_allocation":true,"bit_alignment":"byte_aligned","bit_size":8,"endian":"unspec","is_signed":false,"is_common_supported":true}},{"node_type":"ident","loc":{"pos":{"begin":396,"end":416},"file":1,"line":20,"col":21},"body":{"expr_type":59,"constant_level":"variable","ident":"credential_id_length","usage":"reference","base":58,"scope":3}},{"node_type":"field","loc":{"pos":{"begin":425,"end":446},"file":1,"line":21,"col":5},"body":{"belong":50,"belong_struct":53,"ident":66,"colon_loc":{"pos":{"begin":447,"end":448},"file":1,"line":21,"col":27},"is_state_variable":false,"field_type":67,"arguments":null,"offset_bit":null,"offset_recent":0,"tail_offset_bit":null,"tail_offset_recent":0,"bit_alignment":"not_target","eventual_bit_alignment":"not_target","follow":"unknown","eventual_follow":"unknown","next":null}},{"node_type":"ident","loc":{"pos":{"begin":425,"end":446},"file":1,"line":21,"col":5},"body":{"expr_type":67,"constant_level":"variable","ident":"credential_public_key","usage":"define_field","base":65,"scope":3}},{"node_type":"ident_type","loc":{"pos":{"begin":448,"end":467},"file":1,"line":21,"col":28},"body":{"is_explicit":true,"non_dynamic_allocation":false,"bit_alignment":"not_target","bit_size":null,"import_ref":null,"ident":68,"base":null}},{"node_type":"ident","loc":{"pos":{"begin":448,"end":467},"file":1,"line":21,"col":28},"body":{"expr_type":null,"constant_level":"unknown","ident":"CredentialPublicKey","usage":"maybe_type","base":null,"scope":3}}],"scope":[{"owner":0,"ident":[3],"branch":1,"next":2,"prev":null,"branch_root":true},{"owner":2,"ident":[7,10,13,16,22,25,28,31,37,40,43,47],"branch":null,"next":2,"prev":0,"branch_root":true},{"owner":0,"ident":[51],"branch":3,"next":null,"prev":0,"branch_root":false},{"owner":50,"ident":[55,58,61,64,66],"branch":null,"next":null,"prev":2,"branch_root":true}]},"error": {"errs": [{"msg": "type is not found","file": "C:/workspace/shbrgen/brgen/example/attestation_object.bgn","loc": {"pos": {"begin": 261,"end": 284},"file": 1,"line": 14,"col": 17},"src": "  14|    extensions :AuthenticatorExtensions\n                     ^^^^^^^^^^^^^^^^^^^^^^^","warn": true},{"msg": "type is not found","file": "C:/workspace/shbrgen/brgen/example/attestation_object.bgn","loc": {"pos": {"begin": 448,"end": 467},"file": 1,"line": 21,"col": 28},"src": "  21|    credential_public_key :CredentialPublicKey\n                                ^^^^^^^^^^^^^^^^^^^","warn": true}]}}